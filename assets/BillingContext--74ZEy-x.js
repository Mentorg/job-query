import{r,d as P,j as M}from"./index-2jHbxyPx.js";import{r as E}from"./recruiter-XSYqMn4-.js";import{s as U}from"./subscription-Gza7dgBC.js";import{c as A}from"./company-dghI85Gw.js";const C=[{id:36,email:"janedoe@innovize.com",is_autorenew:!1,created_at:"01.01.2016",user_id:36},{id:35,email:"sarabrown@example.com",is_autorenew:!1,created_at:"01.01.2016",user_id:35},{id:34,email:"michaelwilson@example.com",is_autorenew:!1,created_at:"01.01.2016",user_id:34},{id:33,email:"emilybrown@example.com",is_autorenew:!1,created_at:"01.01.2016",user_id:33}],B=[{id:0,name:"Innovize",card_type:"Visa",card_number:"1234 5678 9012 3456",expiration_date:"05/26",cvv:"123",is_active:!0,company_id:0},{id:1,name:"Innovize",card_type:"MasterCard",card_number:"9876 5432 1098 7654",expiration_date:"04/27",cvv:"456",is_active:!1,company_id:0}],D=r.createContext({billing:[],user:{},payment_method:[],dispatch:()=>{},userEmail:[],userCompany:void 0,companyPaymentMethods:void 0,companySubscription:void 0,handleUpdateEmail:()=>{},handleAddPaymentMethod:()=>{},handleUpdatePaymentMethod:()=>{},handleUpdateAutoRenew:()=>{},handleSetDefaultCard:()=>{},handleDeleteCard:()=>{}});function I({children:u}){const{user:a}=P(),l=E.find(e=>e.id===(a==null?void 0:a.id)),i=A.find(e=>e.id===(l==null?void 0:l.company_id)),s=U.find(e=>e.id===(i==null?void 0:i.subscription_id)),_={billing:C,user:a,payment_method:B};function c(e,n){switch(n.type){case"email/update":{const t=e.billing.map(o=>{var p;return o.user_id===((p=e.user)==null?void 0:p.id)?{...o,email:n.email.email||o.email}:o});return{...e,billing:t}}case"payment_method/add":return{...e,payment_method:[...e.payment_method,n.payment_method]};case"payment_method/update":return{...e,payment_method:e.payment_method.map(t=>t.id===n.payment_method.id?n.payment_method:t)};case"payment_method/default":return{...e,payment_method:e.payment_method.map(t=>({...t,is_active:t.id===n.id}))};case"payment_method/delete":return{...e,payment_method:e.payment_method.filter(t=>t.id!==n.id)};case"autorenew/is_autorenew":return{...e,billing:e.billing.map(t=>({...t,is_autorenew:t.user_id===(a==null?void 0:a.id)?!t.is_autorenew:t.is_autorenew}))};default:return e}}const[m,d]=r.useReducer(c,_),y=m.billing.filter(e=>e.user_id===(a==null?void 0:a.id)).map(e=>e.email),h=m.payment_method.filter(e=>e.company_id===(i==null?void 0:i.id));function f(e){d({type:"email/update",email:e})}function w(e){d({type:"payment_method/add",payment_method:e})}function v(e){d({type:"payment_method/update",payment_method:e})}function b(e){d({type:"payment_method/default",id:e})}function x(e){d({type:"payment_method/delete",id:e})}function g(){var e;if(m.user){const n=(e=m.user)==null?void 0:e.id;d({type:"autorenew/is_autorenew",payload:{userId:n}})}}return M.jsx(D.Provider,{value:{...m,user:a,dispatch:d,userEmail:y,userCompany:i,companyPaymentMethods:h,companySubscription:s,handleUpdateEmail:f,handleAddPaymentMethod:w,handleUpdatePaymentMethod:v,handleUpdateAutoRenew:g,handleSetDefaultCard:b,handleDeleteCard:x},children:u})}export{D as BillingContext,I as default};
